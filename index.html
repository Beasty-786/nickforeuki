<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>For Selly ❤️</title>

<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Dancing+Script:wght@600&display=swap" rel="stylesheet">

<style>
html,body{
  height:100%;
  margin:0;
  font-family:Arial,Helvetica,sans-serif;
  overflow:hidden;
  background:#000;
}

/* REAL IMAGE BACKGROUND (Safari safe) */
.bg{
  position:fixed;
  inset:0;
  z-index:-2;
  overflow:hidden;
}

.bg img{
  width:100%;
  height:100%;
  object-fit:cover;
  filter:blur(20px) brightness(0.55);
  transform:scale(1.1);
}

/* floating particles */
.particle{
  position:fixed;
  bottom:-60px;
  font-size:22px;
  opacity:0.5;
  pointer-events:none;
  animation:floatUp linear infinite;
}
@keyframes floatUp{
  from{transform:translateY(0)}
  to{transform:translateY(-120vh)}
}

/* gift */
.scene{
  height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
  position:relative;
}
.tap-text{
  position:absolute;
  top:16vh;
  color:#fff;
  font-size:18px;
  font-weight:600;
}
.box{
  width:220px;
  height:220px;
  perspective:900px;
  cursor:pointer;
}
.box-body{
  width:100%;
  height:100%;
  border-radius:14px;
  background:linear-gradient(145deg,#ff7aa2,#ff3b7a);
  position:relative;
  box-shadow:0 30px 80px rgba(0,0,0,0.7);
}
.box-lid{
  position:absolute;
  inset:0;
  border-radius:14px;
  transform-origin:top;
  transition:transform 0.7s ease;
  background:linear-gradient(145deg,#ff7aa2,#ff3b7a);
}
.box-bowtie{
  position:absolute;
  width:68px;
  height:34px;
  background:#fff;
  border-radius:40px;
  top:-20px;
  left:50%;
  transform:translateX(-50%);
}
.flower{
  position:absolute;
  left:50%;
  bottom:-220px;
  transform:translateX(-50%);
  width:170px;
  opacity:0;
  transition:bottom 0.9s ease, opacity 0.6s ease;
}

/* carousel */
.memory-section{
  display:none;
  height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
  perspective:1200px;
}
.carousel{
  position:relative;
  width:100%;
  max-width:900px;
  height:520px;
  display:flex;
  align-items:center;
  justify-content:center;
}
.card{
  position:absolute;
  width:85vw;
  max-width:420px;
  background:#fff;
  border-radius:12px;
  padding:14px;
  text-align:center;
  box-shadow:0 30px 70px rgba(0,0,0,0.6);
  transition:transform .6s cubic-bezier(.22,1,.36,1),opacity .6s,filter .6s;
  display:flex;
  flex-direction:column;
  gap:10px;
}
.card-media{
  width:100%;
  max-height:50vh;
  border-radius:8px;
  overflow:hidden;
}
.card-media img{
  width:100%;
  height:100%;
  object-fit:cover;
}
.card-media iframe{
  width:100%;
  height:320px;
  border:0;
}
.date{
  font-family:'Playfair Display',serif;
  font-weight:700;
}
.caption{
  font-family:'Dancing Script',cursive;
  font-size:20px;
  white-space:pre-line;
}

/* timeline */
.timeline{
  width:0%;
  height:6px;
  background:linear-gradient(90deg,#ff4f81,#fff,#ff4f81);
  border-radius:10px;
  transition:width 3s ease;
}
.counter{
  font-family:'Playfair Display',serif;
  font-weight:700;
  font-size:22px;
  margin-top:10px;
}
.heart{
  font-size:64px;
  margin-top:10px;
  animation:pulse 1.6s infinite;
}
@keyframes pulse{
  0%{transform:scale(1)}
  50%{transform:scale(1.25)}
  100%{transform:scale(1)}
}
.final-title{
  font-family:'Playfair Display',serif;
  font-weight:700;
  font-size:24px;
}
.final-text{
  font-family:'Dancing Script',cursive;
  font-size:20px;
}
</style>
</head>
<body>

<!-- REAL BLURRED BACKGROUND IMAGE -->
<div class="bg">
  <img id="bgImg" src="./mem1.jpeg" alt="">
</div>

<!-- Gift -->
<div class="scene" id="giftScene">
  <div class="tap-text">Tap on me</div>
  <div class="box" id="giftBox">
    <div class="box-body">
      <img class="flower" src="./flowers.png" id="flower">
      <div class="box-lid" id="lid"></div>
      <div class="box-bowtie"></div>
    </div>
  </div>
</div>

<!-- Memories -->
<div class="memory-section" id="memorySection">
  <div class="carousel" id="carousel"></div>
</div>

<audio id="music" loop>
  <source src="./athousandyears.mp3" type="audio/mpeg">
</audio>

<script>
const memories = [
  { type:'img', src:'./mem1.jpeg', date:'15 May 2024', cap:`The day we started talking.\nNow it’s us.` },
  { type:'img', src:'./mem2.jpeg', date:'01 Aug 2024', cap:`Girlfriend's Day.\nYou deserved that cake.` },
  { type:'img', src:'./mem3.jpeg', date:'28 Sep 2024', cap:`Our first meet up.\nIt felt real.` },
  { type:'video', src:'https://streamable.com/e/2c6hpr', date:'15 May 2025', cap:`One year together.\nWe stayed.` },
  { type:'timeline' }
];

let current = 0;
let timelineStarted = false;
const bgImg = document.getElementById("bgImg");

function updateBG(){
  if(memories[current].type === "img"){
    bgImg.src = memories[current].src;
  }
}

function openBox(){
  document.getElementById("lid").style.transform = "rotateX(-120deg)";
  setTimeout(()=>{
    const flower = document.getElementById("flower");
    flower.style.opacity="1";
    flower.style.bottom="30px";
  },600);
  setTimeout(()=>{
    document.getElementById("giftScene").style.display="none";
    document.getElementById("memorySection").style.display="flex";
    document.getElementById("music").play().catch(()=>{});
    render();
  },1500);
}
document.getElementById("giftBox").addEventListener("click",openBox);

const carousel = document.getElementById("carousel");

function render(){
  carousel.innerHTML="";
  memories.forEach((m,i)=>{
    const card=document.createElement("div");
    card.className="card";
    const offset=i-current;
    card.style.transform=`translateX(${offset*360}px) scale(${offset===0?1:0.8})`;
    card.style.opacity=offset===0?1:0.6;
    card.style.filter=offset===0?"blur(0px)":"blur(4px)";

    if(m.type==="img"){
      card.innerHTML=`<div class="card-media"><img src="${m.src}"></div>
      <div class="date">${m.date}</div>
      <div class="caption">${m.cap}</div>`;
    }
    else if(m.type==="video"){
      card.innerHTML=`<div class="card-media"><iframe src="${m.src}" allowfullscreen></iframe></div>
      <div class="date">${m.date}</div>
      <div class="caption">${m.cap}</div>`;
    }
    else if(m.type==="timeline"){
      card.innerHTML=`<div class="date">15 May 2024 → Today</div>
      <div class="timeline" id="line"></div>
      <div class="counter" id="counter">0 days</div>`;
      startTimeline(card);
    }

    carousel.appendChild(card);
  });
  updateBG();
}

/* Swipe */
let startX=0;
document.addEventListener("touchstart",e=>{
  startX=e.touches[0].clientX;
});
document.addEventListener("touchend",e=>{
  let diff=e.changedTouches[0].clientX-startX;
  if(diff<-80 && current<memories.length-1) current++;
  if(diff>80 && current>0) current--;
  render();
});

/* Timeline */
function startTimeline(card){
  if(timelineStarted) return;
  timelineStarted=true;
  const startDate=new Date("2024-05-15");
  const today=new Date();
  const totalDays=Math.floor((today-startDate)/(1000*60*60*24));
  setTimeout(()=>{document.getElementById("line").style.width="100%";},500);
  let count=0;
  const counter=document.getElementById("counter");
  const interval=setInterval(()=>{
    count+=Math.ceil(totalDays/60);
    if(count>=totalDays){
      count=totalDays;
      clearInterval(interval);
      card.innerHTML+=`
      <div class="heart">❤️</div>
      <div class="final-title">Happy Valentine Day ❤️</div>
      <div class="final-text">Till forever.</div>`;
    }
    counter.innerText=count+" days";
  },40);
}
</script>
</body>
</html>