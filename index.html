<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>For Selly ‚ù§Ô∏è</title>

<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600&family=Dancing+Script:wght@600&display=swap" rel="stylesheet">

<style>
body{
  margin:0;
  overflow:hidden;
  background:#000;
  font-family:Arial;
}

/* Dynamic blurred background */
.bg{
  position:fixed;
  width:100%;
  height:100%;
  background-size:cover;
  background-position:center;
  filter:blur(25px) brightness(0.35);
  transform:scale(1.2);
  z-index:-2;
  transition:1s;
}

/* Glowing particles */
.particle{
  position:fixed;
  bottom:-40px;
  font-size:22px;
  opacity:0.4;
  filter:blur(1px);
  animation:floatUp linear infinite;
  pointer-events:none;
}

@keyframes floatUp{
  from{transform:translateY(0);}
  to{transform:translateY(-110vh);}
}

/* Gift box 3D */
.scene{
  height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  perspective:1000px;
}

.box{
  width:160px;
  height:160px;
  position:relative;
  transform-style:preserve-3d;
  cursor:pointer;
}

.face{
  position:absolute;
  width:100%;
  height:100%;
  background:#ff4f81;
  border:4px solid #fff;
}

.lid-top{transform-origin:top; transition:0.6s;}
.lid-left{transform-origin:left; transition:0.6s;}
.lid-right{transform-origin:right; transition:0.6s;}
.lid-front{transform-origin:bottom; transition:0.6s;}

.memory-section{
  display:none;
  height:100vh;
  position:relative;
  color:white;
}

.carousel{
  height:100%;
  display:flex;
  align-items:center;
  justify-content:center;
  position:relative;
}

.card{
  position:absolute;
  width:260px;
  background:white;
  color:black;
  padding:15px;
  text-align:center;
  transition:0.6s ease;
  box-shadow:0 15px 35px rgba(0,0,0,0.7);
}

.card img,
.card video{
  width:100%;
}

.date{
  font-family:'Playfair Display',serif;
  margin-top:8px;
}

.caption{
  font-family:'Dancing Script',cursive;
  font-weight:bold;
  font-size:19px;
  margin-top:6px;
}

/* Timeline */
.timeline{
  width:80%;
  height:4px;
  background:linear-gradient(to right,#ff4f81,#fff,#ff4f81);
  margin:20px auto;
  position:relative;
  animation:glow 2s infinite alternate;
}

@keyframes glow{
  from{opacity:0.5;}
  to{opacity:1;}
}

.dot{
  width:18px;
  height:18px;
  background:#fff;
  border-radius:50%;
  position:absolute;
  top:-7px;
}

.heart{
  font-size:60px;
  animation:pulse 1.6s infinite;
  text-align:center;
}

@keyframes pulse{
  0%{transform:scale(1);}
  50%{transform:scale(1.2);}
  100%{transform:scale(1);}
}

.final-text{
  font-family:'Dancing Script',cursive;
  font-weight:bold;
  font-size:22px;
  text-align:center;
  margin-top:10px;
}
</style>
</head>

<body>

<div class="bg" id="bg"></div>

<div class="scene" id="giftScene">
  <div class="box" onclick="openBox()">
    <div class="face lid-top"></div>
    <div class="face lid-left"></div>
    <div class="face lid-right"></div>
    <div class="face lid-front"></div>
  </div>
</div>

<div class="memory-section" id="memorySection">
  <div class="carousel" id="carousel"></div>
</div>

<audio id="music" loop>
  <source src="athousandyears.mp3" type="audio/mpeg">
</audio>

<script>

/* Floating glowing particles always */
function createParticle(){
  const p=document.createElement("div");
  p.className="particle";
  p.innerHTML=Math.random()>0.5?"‚ù§Ô∏è":"üåπ";
  p.style.left=Math.random()*100+"vw";
  p.style.fontSize=(20+Math.random()*20)+"px";
  p.style.animationDuration=(10+Math.random()*10)+"s";
  document.body.appendChild(p);
  setTimeout(()=>p.remove(),20000);
}
setInterval(createParticle,900);

/* Gift open */
let openStep=0;
function openBox(){
  const faces=document.querySelectorAll(".face");
  openStep++;
  if(openStep===1) faces[0].style.transform="rotateX(-120deg)";
  if(openStep===2) faces[1].style.transform="rotateY(-120deg)";
  if(openStep===3) faces[2].style.transform="rotateY(120deg)";
  if(openStep===4){
    faces[3].style.transform="rotateX(120deg)";
    setTimeout(()=>{
      document.getElementById("giftScene").style.display="none";
      document.getElementById("memorySection").style.display="block";
      document.getElementById("music").play();
      initCarousel();
    },800);
  }
}

/* Memories */
const memories=[
  {type:"img",src:"mem1.jpeg",date:"15 May 2024",cap:"The day we started talking. We had no idea it would turn into this."},
  {type:"img",src:"mem2.jpeg",date:"1 Aug 2024",cap:"Girlfriend‚Äôs Day. That little bento cake because you deserve sweet things."},
  {type:"img",src:"mem3.jpeg",date:"28 Sep 2024",cap:"Our first meet up. Seeing you in real life felt different."},
  {type:"video",src:"memory4.mp4",date:"15 May 2025",cap:"One year together. Through everything, we stayed."},
  {type:"final"}
];

let current=0;

function initCarousel(){
  render();
  updateBG();
}

function render(){
  const container=document.getElementById("carousel");
  container.innerHTML="";
  memories.forEach((m,i)=>{
    const card=document.createElement("div");
    card.className="card";

    if(i===current){
      card.style.transform="translateX(0) scale(1)";
      card.style.zIndex=3;
      card.style.filter="blur(0)";
    }
    else if(i===current-1){
      card.style.transform="translateX(-200px) scale(0.8)";
      card.style.zIndex=2;
      card.style.filter="blur(4px)";
    }
    else if(i===current+1){
      card.style.transform="translateX(200px) scale(0.8)";
      card.style.zIndex=2;
      card.style.filter="blur(4px)";
    }
    else{
      card.style.display="none";
    }

    if(m.type==="img"){
      card.innerHTML=`<img src="${m.src}">
      <div class="date">${m.date}</div>
      <div class="caption">${m.cap}</div>`;
    }
    else if(m.type==="video"){
      card.innerHTML=`<video controls playsinline>
      <source src="${m.src}" type="video/mp4">
      </video>
      <div class="date">${m.date}</div>
      <div class="caption">${m.cap}</div>`;
    }
    else{
      card.innerHTML=`<div id="finalStage"></div>`;
      startFinal();
    }

    container.appendChild(card);
  });
}

function updateBG(){
  const bg=document.getElementById("bg");
  if(memories[current].src){
    bg.style.backgroundImage=`url(${memories[current].src})`;
  }
}

/* Swipe */
let startX=0;
document.addEventListener("touchstart",e=>startX=e.touches[0].clientX);
document.addEventListener("touchend",e=>{
  let diff=e.changedTouches[0].clientX-startX;
  if(diff>50 && current>0){current--; render(); updateBG();}
  if(diff<-50 && current<memories.length-1){current++; render(); updateBG();}
});

/* Final timeline */
function startFinal(){
  const el=document.getElementById("finalStage");
  if(!el) return;

  const startDate=new Date("2024-05-15");
  const today=new Date();
  const diff=Math.floor((today-startDate)/(1000*60*60*24));

  el.innerHTML=`
    <div class="date">15 May 2024 ‚Üí Today</div>
    <div class="timeline"><div class="dot" style="left:100%"></div></div>
    <div class="caption">${diff} days</div>
  `;

  setTimeout(()=>{
    el.innerHTML+=`<div class="heart">‚ù§Ô∏è</div>
    <div class="final-text">
    Happy Valentine bby ‚ù§Ô∏è<br>
    Thank you for being with me.<br>
    Till forever.
    </div>`;
  },2500);
}

</script>

</body>
</html>
